$(function(){"use strict";$("form#route-comment-form").validate(),$("form#route-comment-form").submit(function(a){var b=$("select#route").find("option:selected").val();$("<input />").attr("type","hidden").attr("name","route").attr("value",b).appendTo("form#route-comment-form"),$("ul#route-comments li").remove();var c=$("form#route-comment-form").serializeArray();return ajax("/addroutecomment",c,function(a){console.log(a),$("ul#route-comments").show(),a.length>0?a.forEach(function(a){console.log(a),$("ul#route-comments").append("<li><p>"+a.text+"<br><small>"+a.datePosted+"</small></p><hr></li>")}):$("ul#route-comments").append("<li><p><i>No Comments for Route</i></p></li>")}),a.preventDefault(),!1}),$("select#route").change(function(){var a=$("select#route").find("option:selected"),b=a.val();$("div#results-area").hide(),$("#stop-list").hide(),$("ul#messages li").remove();var c={rt:b};ajax("/getdirections",c,function(a){console.log(a),$("#direction option").remove(),$("#stop option").remove(),$("#direction").append('<option value="" disabled selected>Select Direction</option>'),$("label#direction-list").show(),a.forEach(function(a){$("#direction").append('<option value="'+a.tag+'">'+a.name+"</option>")})})}),$("select#direction").change(function(){var a=$("select#direction").find("option:selected"),b=a.val();$("div#results-area").hide(),$("ul#messages li").remove();var c={dir:b};ajax("/getstops",c,function(a){console.log(a),$("#stop option").remove(),$("#stop").show(),$("#stop").append('<option value="" disabled selected>Select Stop</option>'),$("label#stop-list").show(),a.forEach(function(a){$("#stop").append('<option value="'+a.tag+'">'+a.name+"</option>")})})}),$("select#stop").change(function(){var a=$("select#stop").find("option:selected"),b=a.val(),c=$("select#route").find("option:selected"),d=c.val();$("div#results-area").show();var e=$("div#results-area").position().top;$(window).scrollTop(e),$("ul#messages li").remove(),$("ul#route-comments li").remove();var f={route:d,stop:b};ajax("/getpredictions",f,function(a){console.log(a),$("div#predictions-box").html('<h2>Predictions</h2><ul id="predictions"></ul>'),a.messages.forEach(function(a){$("ul#messages").append("<li><p>"+a.text+"</p></li>")}),a.predictions_data.length>0?a.predictions_data.forEach(function(a){$("ul#predictions").append("<h5>"+a.title+"</h5>"),a.predictions.forEach(function(a){$("ul#predictions").append('  <li><p><a href="http://nuess.net/getvehicle?id='+a.vehicleId+'">Vehicle #'+a.vehicleId+"</a> - <b>"+a.minutes+" minutes</b></p></li>")})}):$("div#predictions-box").append("<h5>No Predictions Available</h5>")});var g={route:d};ajax("/getroutecomments",g,function(a){console.log(a),$("ul#route-comments").show(),a.length>0?a.forEach(function(a){$("ul#route-comments").append("<li><p>"+a.text+"<br><small>"+a.datePosted+"</small></p><hr></li>")}):$("ul#route-comments").append("<li><p><i>No Comments for Route</i></p></li>")})})});
